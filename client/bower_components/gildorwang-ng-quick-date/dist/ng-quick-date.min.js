(function(){var a;a=angular.module("ngQuickDate",[]),a.provider("ngQuickDateDefaults",function(){return{options:{dateFormat:"M/d/yyyy",timeFormat:"h:mm a",labelFormat:null,placeholder:"Click to Set Date",hoverText:null,buttonIconHtml:null,closeButtonHtml:"&times;",nextLinkHtml:"Next &rarr;",prevLinkHtml:"&larr; Prev",disableTimepicker:!1,disableClearButton:!1,defaultTime:null,dayAbbreviations:["Su","M","Tu","W","Th","F","Sa"],dateFilter:null,timezone:null,debug:!1,parseDateFunction:function(a){var b;return b=Date.parse(a),isNaN(b)?null:new Date(b)}},$get:function(){return this.options},set:function(a,b){var c,d,e;if("object"==typeof a){e=[];for(c in a)d=a[c],e.push(this.options[c]=d);return e}return this.options[a]=b}}}),a.directive("quickDatepicker",["ngQuickDateDefaults","$filter","$sce","$log",function(a,b,c,d){return{restrict:"E",require:"?ngModel",scope:{dateFilter:"=?",disableTimepicker:"=?",disableClearButton:"=?",timezone:"=?",onChange:"&",required:"@",debug:"=?"},replace:!0,link:function(e,f,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R;return q="00:00:00",p=function(a){return e.debug?d.debug("[quickdate] "+a):void 0},R=new Date("2015-01-01T12:00Z"),A=function(){return F(),e.toggleCalendar(!1),e.weeks=[],e.inputDate=null,e.inputTime=null,e.invalid=!0,"string"==typeof g.initValue&&h.$setViewValue(g.initValue),E(),D()},e.getDatePlaceholder=function(){return k(R,e.getDateFormat())},e.getTimePlaceholder=function(){return k(R,e.getTimeFormat())},e.getDateFormat=function(){return B()?"yyyy-MM-dd":e.dateFormat},e.getTimeFormat=function(){return B()?"HH:mm:ss":e.timeFormat},e.getLabelFormat=function(){var a;return null!=(a=e.labelFormat)?a:e.disableTimepicker?e.getDateFormat():e.getDateFormat()+" "+e.getTimeFormat()},F=function(){var b,d,f;for(b in a)d=a[b],b.match(/[Hh]tml/)?e[b]=c.trustAsHtml(a[b]||""):null==e[b]&&(e[b]=null!=(f=g[b])?f:a[b]);return g.iconClass&&g.iconClass.length?e.buttonIconHtml=c.trustAsHtml("<i ng-show='iconClass' class='"+g.iconClass+"'></i>"):void 0},l=!1,window.document.addEventListener("click",function(){return e.calendarShown&&!l&&(e.toggleCalendar(!1),e.$apply()),l=!1}),angular.element(f[0])[0].addEventListener("click",function(){return l=!0}),D=function(){var a;return a=h.$modelValue?C(h.$modelValue):null,P(),J(a),e.mainButtonStr=a?k(a,e.getLabelFormat()):e.placeholder,e.invalid=h.$invalid},J=function(a){return null!=a?(e.inputDate=k(a,e.getDateFormat()),e.inputTime=k(a,e.getTimeFormat())):(e.inputDate=null,e.inputTime=null)},E=function(a){var b;return null==a&&(a=null),b=null!=a?new Date(a):new Date,"Invalid Date"===b.toString()&&(b=new Date),G(b,1),e.calendarDate=b},P=function(){var a,b,c,d,f,g,i,j,k,l,n,o,p;for(g=s(e.calendarDate),d=t(u(e.calendarDate),y(e.calendarDate)),f=Math.ceil((g+d)/7),l=[],a=new Date(e.calendarDate),G(a,r(a)+-1*g),i=n=0,p=f-1;p>=0?p>=n:n>=p;i=p>=0?++n:--n)for(l.push([]),c=o=0;6>=o;c=++o)b=new Date(a),O(b,q),j=h.$modelValue&&b&&m(b,h.$modelValue),k=m(b,new Date),l[i].push({date:b,selected:j,disabled:"function"==typeof e.dateFilter?!e.dateFilter(b):!1,other:y(b)!==y(e.calendarDate),today:k}),G(a,r(a)+1);return e.weeks=l},h.$parsers.push(function(a){return e.required&&null==a?(h.$setValidity("required",!1),null):angular.isDate(a)?(h.$setValidity("required",!0),a):angular.isString(a)?(h.$setValidity("required",!0),e.parseDateFunction(a)):null}),h.$formatters.push(function(a){return angular.isDate(a)?a:angular.isString(a)?e.parseDateFunction(a):void 0}),B=function(){return"UTC"===e.timezone},r=function(a){return B()?a.getUTCDate():a.getDate()},s=function(a){return B()?a.getUTCDay():a.getDay()},u=function(a){return B()?a.getUTCFullYear():a.getFullYear()},v=function(a){return B()?a.getUTCHours():a.getHours()},w=function(a){return B()?a.getUTCMilliseconds():a.getMilliseconds()},x=function(a){return B()?a.getUTCMinutes():a.getMinutes()},y=function(a){return B()?a.getUTCMonth():a.getMonth()},z=function(a){return B()?a.getUTCSeconds():a.getSeconds()},G=function(a,b){return B()?a.setUTCDate(b):a.setDate(b)},H=function(a,b){return B()?a.setUTCFullYear(b):a.setFullYear(b)},I=function(a,b){return B()?a.setUTCHours(b):a.setHours(b)},K=function(a,b){return B()?a.setUTCMilliseconds(b):a.setMilliseconds(b)},L=function(a,b){return B()?a.setUTCMinutes(b):a.setMinutes(b)},M=function(a,b){return B()?a.setUTCMonth(b):a.setMonth(b)},N=function(a,b){return B()?a.setUTCSeconds(b):a.setSeconds(b)},O=function(a,b){var c,d,e,f;return c=(null!=b?b:q).split(":"),I(a,null!=(d=c[0])?d:0),L(a,null!=(e=c[1])?e:0),N(a,null!=(f=c[2])?f:0),a},i=function(a,b){return new Date(M(new Date(a),y(a)+b))},k=function(a,c){return b("date")(a,c,e.timezone)},Q=function(a){return"string"==typeof a?C(a):a},C=a.parseDateFunction,j=function(a,b){return B()?""+a+"T"+b+"Z":""+a+" "+b},m=function(a,b,c){return null==c&&(c=!1),c?a-b===0:(a=Q(a),b=Q(b),a&&b&&u(a)===u(b)&&y(a)===y(b)&&r(a)===r(b))},n=function(a,b){return a&&b?parseInt(a.getTime()/6e4)===parseInt(b.getTime()/6e4):!1},t=function(a,b){return[31,a%4===0&&a%100!==0||a%400===0?29:28,31,30,31,30,31,31,30,31,30,31][b]},o=function(a,b){var c,d,e,f,g,h;return g=c=d=h=f=null,e=function(){var a;return a=+new Date-h,g=b>a&&a>0?setTimeout(e,b-a):null},function(){return d=this,c=arguments,h=+new Date,g||(g=setTimeout(e,b),f=a.apply(d,c),d=c=null),f}},h.$render=function(){return E(h.$viewValue),D()},h.$viewChangeListeners.unshift(function(){return E(h.$viewValue),D(),e.onChange?e.onChange():void 0}),e.$watch("calendarShown",function(a){var b;return a?(b=angular.element(f[0].querySelector(".quickdate-date-input"))[0],b.select(),D()):void 0}),e.$watch("timezone",function(a,b){return a!==b?h.$render():void 0}),e.$watch("disableTimepicker",function(a,b){return a!==b?D():void 0}),e.toggleCalendar=o(function(a){return e.calendarShown=isFinite(a)?a:!e.calendarShown},150),e.selectDate=function(a,b){var c;return null==b&&(b=!0),p("selectDate: "+(null!=a?a.toISOString():void 0)),c=!h.$viewValue&&a||h.$viewValue&&!a||a&&h.$viewValue&&a.getTime()!==h.$viewValue.getTime(),"function"!=typeof e.dateFilter||e.dateFilter(a)?(h.$setViewValue(a),b&&e.toggleCalendar(!1),!0):!1},e.selectDateWithMouse=function(a){return e.inputDate=k(a,e.getDateFormat()),e.selectDateFromInput(e.disableTimepicker)},e.selectDateFromInput=function(a){var b,c,d,f,g;null==a&&(a=!1);try{if(c=C(j(e.inputDate,e.defaultTime||q)),null==c)throw new Error("Invalid Date");if(!e.disableTimepicker&&(null!=(g=e.inputTime)?g.length:void 0)){if(f=e.disableTimepicker?q:e.inputTime,d=C(j(e.inputDate,f)),null==d)throw new Error("Invalid Time");c=d}if(!n(h.$viewValue,c)&&!e.selectDate(c,!1))throw new Error("Invalid Date");return a&&e.toggleCalendar(!1),e.inputDateErr=!1,e.inputTimeErr=!1}catch(i){if(b=i,"Invalid Date"===b.message)return e.inputDateErr=!0;if("Invalid Time"===b.message)return e.inputTimeErr=!0}},e.onDateInputTab=function(){return e.disableTimepicker&&e.toggleCalendar(!1),!0},e.onTimeInputTab=function(){return e.toggleCalendar(!1),!0},e.nextMonth=function(){return E(i(e.calendarDate,1)),D()},e.prevMonth=function(){return E(i(e.calendarDate,-1)),D()},e.clear=function(){return e.selectDate(null,!0)},A()},template:"<div class='quickdate'>\n  <a href='' ng-focus='toggleCalendar()' ng-click='toggleCalendar()'\n      class='quickdate-button' title='{{hoverText}}'>\n    <div ng-hide='iconClass' ng-bind-html='buttonIconHtml'></div>\n    {{mainButtonStr}}\n  </a>\n  <div class='quickdate-popup' ng-class='{open: calendarShown}'>\n    <a href='' tabindex='-1' class='quickdate-close' ng-click='toggleCalendar()'>\n      <div ng-bind-html='closeButtonHtml'></div>\n    </a>\n    <div class='quickdate-text-inputs'>\n      <div class='quickdate-input-wrapper'>\n        <label>Date</label>\n        <input class='quickdate-date-input' ng-class=\"{'ng-invalid': inputDateErr}\"\n               name='inputDate' type='text' ng-model='inputDate'\n               placeholder='{{ getDatePlaceholder() }}'\n               ng-enter=\"selectDateFromInput(true)\"\n               ng-blur=\"selectDateFromInput(false)\"\n               on-tab='onDateInputTab()' />\n      </div>\n      <div class='quickdate-input-wrapper' ng-hide='disableTimepicker'>\n        <label>Time</label>\n        <input class='quickdate-time-input'\n               ng-class=\"{'ng-invalid': inputTimeErr}\"\n               name='inputTime'\n               type='text'\n               ng-model='inputTime'\n               placeholder='{{ getTimePlaceholder() }}'\n               ng-enter=\"selectDateFromInput(true)\"\n               ng-blur=\"selectDateFromInput(false)\"\n               on-tab='onTimeInputTab()'>\n      </div>\n    </div>\n    <div class='quickdate-calendar-header'>\n      <a href='' class='quickdate-prev-month quickdate-action-link' tabindex='-1' ng-click='prevMonth()'>\n        <div ng-bind-html='prevLinkHtml'></div>\n      </a>\n      <span class='quickdate-month'>{{calendarDate | date:'MMMM yyyy'}}</span>\n      <a href='' class='quickdate-next-month quickdate-action-link' ng-click='nextMonth()' tabindex='-1' >\n        <div ng-bind-html='nextLinkHtml'></div>\n      </a>\n    </div>\n    <table class='quickdate-calendar'>\n      <thead>\n        <tr>\n          <th ng-repeat='day in dayAbbreviations'>{{day}}</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr ng-repeat='week in weeks'>\n          <td ng-mousedown='selectDateWithMouse(day.date)'\n              ng-click='$event.preventDefault()'\n              ng-class='{\"other-month\": day.other, \"disabled-date\": day.disabled, \"selected\": day.selected, \"is-today\": day.today}'\n              ng-repeat='day in week'>{{day.date | date:'d':timezone}}</td>\n        </tr>\n      </tbody>\n    </table>\n    <div class='quickdate-popup-footer'>\n      <a href='' class='quickdate-clear' tabindex='-1' ng-hide='disableClearButton' ng-click='clear()'>Clear</a>\n    </div>\n  </div>\n</div>"}}]),a.directive("ngEnter",function(){return function(a,b,c){return b.bind("keydown keypress",function(b){return 13===b.which?(a.$apply(c.ngEnter),b.preventDefault()):void 0})}}),a.directive("onTab",function(){return{restrict:"A",link:function(a,b,c){return b.bind("keydown keypress",function(b){return 9!==b.which||b.shiftKey?void 0:a.$apply(c.onTab)})}}})}).call(this);